#### 1、高可用设计手段
        多副本部署，无状态
        负载均衡
        超时机制
        异步化设计
        服务限流
        缓存
        db-sharding
        服务拆分 服务治理
    
#### 2、高并发设计手段
        时间换空间： 压缩减少网络流量
        空间换时间 ：缓存  threadLocal
        注意分层设计：减少开销
        代码优化 ：循环遍历，避免new无效对象，list map扩容，stringbuilder和string，饿汉式先创建好
        cpu cache结构：L1 L2 L3 三级缓存 尽量连续空间访问 提高缓存利用率
        无锁队列的使用
        数据库层面优化：字段尽量结构小，避免select * ，索引优化，减少cpu和IO的使用率

#### 3、服务无状态化设计
        定义：冗余部署的模块完全对等（请求提交到冗余部署的任何一个模块，处理结果都是完全一样的）
        目的：快速扩容 和 弹性缩容
        案列：用户session管理
            用户session放在网关层：存储在外部存储（集中化管理）
    
#### 4、服务负载均衡设计
        硬件 F5 A10 Radware
        LVS 4层
        Nginx 7层
        HAProxy 4层或7层
        
        算法
        随机算法
        轮训
        一致性hash
        。。。。等
        
        故障自动发现
        故障服务自动摘除（服务熔断）
        服务恢复自动发现
        请求自动重试
    
#### 5、服务幂等设计
        读请求  不需要幂等
        写请求  对数据有改变，需要幂等
        
        请求层面:
        同一个请求重复执行和一次执行结果相同
        业务层面：
        同一个用户不重复下单
        商品不超卖
        MQ消费去重
        
        如何设计幂等：
        Mysql的唯一索引【涉及到分布式id的生成】
        分布式锁
        并发转成串行消费【nginx或者rpc框架都会重试  使用token来解决重试的情况】
    
#### 6、分布式锁设计
        定义：分布式环境下，锁定全局唯一资源【请求串行化，表现为互斥锁】
        实现：
         Redis做分布式锁  【lua  setnx  + pexpire】【get  del】    【锁租期问题，主从切换的问题】【官方推荐用redlock】
        设计目的
        强一致性
        高可用性
        锁自动续约以及自动释放
        接入简单
        可视化管理后台，监控
        
        zk临时节点实现
        
        etcd 3.29  grpc自动封装好了
    
#### 7、分布式事务设计
        XA协议
        半消息  本地消息表
        TCC
        Saga  【T异常了是需要重试的，重试明确失败了再执行回滚操作】
        Seata--MT模式
        补偿
    
#### 8、服务降级设计
        定义：当服务整体的负载超出预设的上限阈值
        实现：拒绝部分请求
        拒绝部分老的请求【网关层去做，收包入列 到出列处理的时间差 超过一定时间（比如1s） 直接丢弃】
        优先级请求方式 【非核心请求直接丢弃  网关层放核心接口请求   放在配置中心 做开关】
        随机拒绝方式【随机丢弃一定的比例】
            关闭部分服务
        
        集中式：网关层
        自治层：网关层 >> 业务逻辑层 >> 数据访问层
    
#### 9、服务限流、熔断设计
         限流、熔断目的：防止因为一个服务的异常，导致一个链路崩溃的情况  failback怎么做
        
        hystrix。
        可以自己实现一个熔断器，1秒一个时间窗口，保留10个时间窗口，succ failed timeout reject  当失败比例超过30% 那么需要熔断。请求数也要超过一定数量
        探测 接口  下一个接口请求来的时候  去试一下可以行不行
        
#### 10、服务灰度发布设计
    
        A B test
        金丝雀发布
        灰度发布 黑白之间平滑过渡
        
        灰度策略放到配置中心
        
    
#### 11、服务全链路压测设计
        